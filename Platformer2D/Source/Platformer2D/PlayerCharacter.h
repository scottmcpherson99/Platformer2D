// Fill out your copyright notice in the Description page of Project Settings.

#pragma once

#include "CoreMinimal.h"
#include "PaperCharacter.h"
#include "PlayerCharacter.generated.h"

//enum state for choice of player animation
UENUM(BlueprintType)
enum class EPlayerAnimation : uint8
{
	EIDLE UMETA(DisplayName = "Idle"),
	EWALKING UMETA(DisplayName = "Walking"),
	ERUNNING UMETA(DisplayName = "Running"),
	EJUMPING UMETA(DisplayName = "Jumping"),
	ECHEERING UMETA(DisplayName = "Cheering"),
	EATTACKING UMETA(DisplayName = "Attacking")
};
/**
 * 
 */
UCLASS()
class PLATFORMER2D_API APlayerCharacter : public APaperCharacter
{
	GENERATED_BODY()

public:
		APlayerCharacter();

	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	// <GettersandSetters>
	// Update the value of the players coins
		void SetCoins(float value_);

	// Output the players coins
		const float GetCoins() const;

	// Update the value of the players lives
		void SetLives(float value_);

	// Output the players lives
		const float GetLives() const;
	// </GettersandSetters>
	///////////////////////////////////////////////////////////////////////////////////////////////////////////

	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	// <Animations>
		void UpdateAnimation(EPlayerAnimation desiredAnimation);
	// </Animations>
	///////////////////////////////////////////////////////////////////////////////////////////////////////////



	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	// <Gameplay>
		//player death occurence
		void OnPlayerDeath();
	// </Gameplay>
	///////////////////////////////////////////////////////////////////////////////////////////////////////////


protected:
	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	// <APlayerCharacter>
	virtual void BeginPlay();
	// </APlayerCharacter>
	///////////////////////////////////////////////////////////////////////////////////////////////////////////


	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	// <PlayerInput>
	// APlayerCharacter Input Component
	virtual void SetupPlayerInputComponent(class UInputComponent* PlayerInputComponent) override;

	// </PlayerInput>
	///////////////////////////////////////////////////////////////////////////////////////////////////////////


	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	// <Movement>
	// Jump
	virtual void Jump() override;

	//stop jump
	virtual void StopJumping() override;

	// Move Player
	void MoveRight(float movementValue_);

	//player attack
	void Attack();

	// </Movement>
	///////////////////////////////////////////////////////////////////////////////////////////////////////////


	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	// <Components>
	/** Camera boom positioning the camera beside the character */
	UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category = Camera, meta = (AllowPrivateAccess = "true"))
		class USpringArmComponent* CameraBoom;

	/** Side view camera */
	UPROPERTY(VisibleAnywhere, BlueprintReadOnly, Category = Camera, meta = (AllowPrivateAccess = "true"))
		class UCameraComponent* SideViewCameraComponent;
	// </Components>
    ///////////////////////////////////////////////////////////////////////////////////////////////////////////


	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	// <Flipbook Animations>
		
	// The animation to play while walking
	UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = Animations)
		class UPaperFlipbook* WalkingAnimation;

	// The animation to play while running around
	UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = Animations)
		class UPaperFlipbook* RunningAnimation;

	// The animation to play while idle (standing still)
	UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = Animations)
		class UPaperFlipbook* IdleAnimation;

	// The animation to play while jumping
	UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = Animations)
		class UPaperFlipbook* JumpingAnimation;

		
		// The animation to play while attacking
		UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = Animations)
			class UPaperFlipbook* AttackAnimation;

		// The animation to play while celebrating
		UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = Animations)
			class UPaperFlipbook* CheerAnimation;
		// </Flipbook Animations>
		///////////////////////////////////////////////////////////////////////////////////////////////////////////


		///////////////////////////////////////////////////////////////////////////////////////////////////////////
		// <Animations>
		void UpdateAnimation(UPaperFlipbook* desiredAnimation);

		void SetIdleAnimation();

		FTimerHandle animationTimer;

		bool isAnimPlaying;
		// </Animations>
		///////////////////////////////////////////////////////////////////////////////////////////////////////////


		///////////////////////////////////////////////////////////////////////////////////////////////////////////
		// <Widgets>
		void UpdatePlayerStats();
		// </Widgets>
		///////////////////////////////////////////////////////////////////////////////////////////////////////////
		
		///////////////////////////////////////////////////////////////////////////////////////////////////////////

		
		// <Audio>
		//background music
		//handles playing audio
		UPROPERTY(EditAnywhere, Category = "Audio")
			TSubclassOf<class AAudioManager> audioManager;

		class AAudioManager* audioManagerHandler;

		//sound for player jumping
		UPROPERTY(EditAnywhere, BlueprintReadWrite, Category = "Audio")
			class USoundBase* jumpingSound;
		// </Audio>
		///////////////////////////////////////////////////////////////////////////////////////////////////////////
		
		
		///////////////////////////////////////////////////////////////////////////////////////////////////////////
		// <Attributes>
		//players coins
		float coins = 0;

		//players lives
		float lives = 3;
		// </Attributes>
		///////////////////////////////////////////////////////////////////////////////////////////////////////////
};